describe 'Jaff.Random', ->
  mult = (a, b) ->
    ah = (a >> 16) & 0xffff
    al = a & 0xffff
    bh = (b >> 16) & 0xffff
    bl = b & 0xffff
    (((((ah * bl) + (al * bh)) & 0xffff) << 16) >>> 0) + (al * bl)

  rotl = (value, r) ->
    ((value << r) | (value >>> (32 - r))) >>> 0

  seed = parseInt('10101010101010101010101010101010',2);  // 2863311530
  expect(seed).toBe(2863311530)
x = (seed >> 16) + 4125832013;  // 4125810167
y = (seed & 0xffff) +  814584116;  // 814627806
z = 542;
console.log(x.toString(2), y.toString(2), z.toString(2));
/*
  123456789-123456789-123456789-12
x 11110101111010101101110111110111
y 00110000100011100011101111011110
z 00000000000000000000001000011110
*/
                         // 123456789-123456789-123456789-12
x = mult(x, 255519323);  // 3696667853
x.toString(2);           // 11011100010101101010110011001101
                         //                    1101110001010
                         // 1101010110011001101
x = rotl(x, 13);         // 3583622026
x.toString(2);           // 11010101100110011011101110001010

                          // 123456789-123456789-123456789-12
y = mult(y, 3166389663);  // 1101268194
y.toString(2);            // 01000001101001000000010011100010
                          //                01000001101001000
                          // 000010011100010
y = rotl(y, 17);          // 163873608
y.toString(2);            // 00001001110001001000001101001000

                   // 123456789-123456789-123456789-12
                   // 000000000001000011110
                   //                      00000000000
z0 = rotl(z, 11);  // 1110016
z0.toString(2);    // 00000000000100001111000000000000
z1 = (~z0 >>> 0);  // 11111111111011110000111111111111

                   // 00000000000000000000001000011110
                   // 11111111111011110000111111111111
                   //                                1
                   // 11111111111011110001001000011110
z -= rotl(z, 11);  // -1109474
                   // 11110
                   //      111111111110111100010010000
z = rotl(z, 27);   // 4160714896
z.toString(2);     // 11110111111111110111100010010000

x.toString(2);               // 11010101100110011011101110001010
y.toString(2);               // 00001001110001001000001101001000
((x ^ y) >>> 0).toString(2); // 11011100010111010011100011000010
z.toString(2);               // 11110111111111110111100010010000
r = (x ^ y ^ z);             // 732053586
r.toString(2);               // 00101011101000100100000001010010
});
